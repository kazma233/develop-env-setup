input {
  file {
    # sincedb_path => "sincedb"
    path => ["/blog_logs/error/error14.log"]
    start_position => "beginning"
    codec => multiline {
        pattern => "^[0-9]{4,4}-[0-9]{2,2}-[0-9]{2,2} [0-9]{2,2}:[0-9]{2,2}:[0-9]{2,2}.[0-9]{1,3}"
        negate => true
        what => "previous"
    }
  }
}
filter {
    grok {
        # 从message中，使用正则获得字符串并且赋值给logdate
        match => [
           "message", "%{LOGLEVEL:loglevel}"
        ]
        # add_field => {"loglevel" => "%{loglevel}"}
    }
    grok {
        # 从message中，使用正则获得字符串并且赋值给logdate
        match => [
           "message", "(?<logdate>[0-9]{4,4}-[0-9]{2,2}-[0-9]{2,2} [0-9]{2,2}:[0-9]{2,2}:[0-9]{2,2}.[0-9]{1,3})"
        ]
    }
    # 把logdate用作elasticsearch的筛选时间
    date {
        match => ["logdate", "yyyy-MM-dd HH:mm:ss.SSS"]
    }
}
output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "blog-log"
  }
}